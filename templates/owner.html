{% extends 'base.html' %}

{% block title %}Dashboard{% endblock title %}

{% block body %}
    <div class="position-fixed top-50 start-50 translate-middle bg-white border rounded shadow p-3" style="width: 80%; max-width: 850px; z-index: 1050;">    
        {% if bikes|length==0 %}
            <div class="alert-danger alert text-center text-danger fw-bold" role="alert">
                <p class="fs-4">INVENTORY EMPTY!!!</p> 
                <a href="{{url_for('add_bike')}}" class="btn btn-success rounded-4">Add New Bike</a>
            </div>
        {% else %}
            <h2 class="text-center sticky-top">Bike Inventory</h2>
            <div style="max-height: 380px; overflow-y: auto;">
                <table class="table text-center">
                    <thead class="sticky-top mt-3">
                        <tr>
                            <th scope="col">SNo</th>
                            <th scope="col">Make</th>
                            <th scope="col">Model</th>
                            <th scope="col">Year</th>
                            <th scope="col">Price</th>
                            <th scope="col">In Stock</th>
                            <th scope="col"></th>
                            <th scope="col"></th>
                            <th scope="col"></th>
                            <th scope="col"></th>
                            <th scope="col"></th>
                        </tr>
                    </thead>
                    <tbody class="table-group-divider scrollable-table">
                        {% for bike in bikes%}
                            <tr>
                                <th scope="row">{{loop.index}}</th>
                                <td>{{bike[1]}}</td>
                                <td>{{bike[2]}}</td>
                                <td>{{bike[3]}}</td>
                                <td>{{bike[4]}}</td>
                                <td>{{bike[5]}}</td>
                                
                                {% if bike[5]==0 %}
                                    <td class="text-danger fw-bold">SOLD OUT!</td>
                                {% else %}
                                    <form action="/" method="post">
                                        <input type="hidden" name="bike_id" value="{{bike[0]}}">
                                        <td><button type="submit" class="btn btn-sm btn-outline-success">BUY</button></td>
                                    </form>
                                {% endif %}
                                <form action="/edit_bike/{{bike[0]}}" method="post">
                                    <input type="hidden" name="bike_id" value="{{bike[0]}}">
                                    <td><button type="submit" class="btn btn-sm btn-outline-primary">EDIT</button></td>
                                </form>
                                <form action="/remove_bike/{{bike[0]}}" method="post" onsubmit="return confirm('Are you sure you want to remove this bike from the Inventory?');">
                                    <input type="hidden" name="bike_id" value="{{bike[0]}}">
                                    <td><button type="submit" class="btn btn-sm btn-outline-danger">REMOVE</button></td>
                                </form>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="container mx-auto pt-3 float-end"> 
                <a href="{{url_for('add_bike')}}" class="btn btn-success rounded-4 float-end">Add New Bike</a>
            </div>
        {% endif %}
    </div>
{% endblock body %}